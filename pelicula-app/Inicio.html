<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Yami Lat - Tu Guía de Anime</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="bg-gray-900 text-white">
    <!-- Facebook SDK for Comments Plugin -->
    <div id="fb-root"></div>
    <script type="module">
      import { fbAppId } from "./config.js";
      const fbSdkScript = document.createElement("script");
      fbSdkScript.async = true;
      fbSdkScript.defer = true;
      fbSdkScript.crossOrigin = "anonymous";
      fbSdkScript.src = `https://connect.facebook.net/es_LA/sdk.js#xfbml=1&version=v18.0&appId=${fbAppId}`;
      fbSdkScript.nonce = "YOUR_NONCE"; // Consider generating a dynamic nonce for production
      document.head.appendChild(fbSdkScript);
    </script>

    <!-- Base de datos local para el contenido por defecto -->
    <div
      id="local-media-data"
      data-media-type="movie"
      data-media-id="372058"
      data-play-url-template="https://www.themoviedb.org/tv/31910"
      class="hidden"
    ></div>

    <div id="app-root"></div>
    <div id="notification-container" class="fixed bottom-4 right-4 z-50"></div>
    <script type="module" src="main.js"></script>
    <script src="lazy-loader.js"></script>
    <script>
      function updateAdultContentButtonVisibility() {
        const adultContentEnabled = localStorage.getItem("adultContentEnabled") === "true";
        console.log("adultContentEnabled from localStorage:", adultContentEnabled); // Debugging line
        // Corrected selector to match the actual href attribute of the +18 button
        const adultContentNavLink = document.querySelector('a[href="go:adult"]');
        if (adultContentNavLink) {
          if (adultContentEnabled) {
            adultContentNavLink.style.display = 'flex'; // Show the button
          } else {
            adultContentNavLink.style.display = 'none'; // Hide the button
          }
        }
      }

      document.addEventListener("DOMContentLoaded", updateAdultContentButtonVisibility);
      window.addEventListener("storage", updateAdultContentButtonVisibility); // Listen for changes in localStorage from other tabs/windows

      document.addEventListener("DOMContentLoaded", () => {
        const urlParams = new URLSearchParams(window.location.search);
        const themeParam = urlParams.get("theme");
        const defaultTheme = "purple"; // Define the default theme here

        let themeToApply = defaultTheme;
        if (themeParam && themeParam !== "default") {
          themeToApply = themeParam;
        }

        if (themeToApply === "purple") {
          document.body.classList.add("purple-theme");
        } else if (themeToApply === "dark") {
          document.body.classList.add("dark-theme");
        }
        // Add more themes here if needed in the future
      });
    </script>
  
    <nav class="fixed bottom-0 left-0 right-0 bg-gray-900/80 backdrop-blur-sm border-t border-gray-700 flex justify-around p-2 z-50">
          <a href="go:home" aria-label="Inicio" data-section="home" class="nav-link flex flex-col items-center text-gray-400 w-1/4 py-1 rounded-lg">
            <i class="fas fa-home text-lg md:text-xl mb-1"></i>
            <span class="text-xs font-semibold">Inicio</span>
          </a>
          <a href="go:explorar" aria-label="Explorar" data-section="explorar" class="nav-link flex flex-col items-center text-gray-400 w-1/4 py-1 rounded-lg">
            <i class="fas fa-compass text-lg md:text-xl mb-1"></i>
            <span class="text-xs font-semibold">Explorar</span>
          </a>
          <a href="go:favoritos" aria-label="Favoritos" data-section="favoritos" id="nav-link-favoritos" class="nav-link flex flex-col items-center text-gray-400 w-1/4 py-1 rounded-lg">
            <i class="fas fa-heart text-lg md:text-xl mb-1"></i>
            <span class="text-xs font-semibold">Favoritos</span>
          </a>
        
          <a href="go:adult" aria-label="Contenido +18" data-section="adult-content" class="nav-link flex flex-col items-center text-gray-400 w-1/4 py-1 rounded-lg" style="display: none;">
            <i class="fas fa-fire text-lg md:text-xl mb-1"></i>
            <span class="text-xs font-semibold">+18</span>
          </a>
        
          <a href="go:ajust" aria-label="Configuración" data-section="configuracion" class="nav-link flex flex-col items-center text-gray-400 w-1/4 py-1 rounded-lg">
            <i class="fas fa-cog text-lg md:text-xl mb-1"></i>
            <span class="text-xs font-semibold">Configuración</span>
          </a>
        </nav>
  </body>
</html>
